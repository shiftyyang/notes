#### 方案背景：

​	基于 UC “服务访问授权”安全性问题引出的系统性思考，目前缺乏一套系统内部间调用的统一鉴权服务。

#### 现状描述：

1. 各应用间调用使用简单的token机制，无法保证安全问题。
2. 每个应用维护一套鉴权机制，重复开发，不利于统一管理。
3. 无法识别访问者身份
4. 对于各应用调用接口，没有权限范围控制

#### 方案：

1. **方案介绍**

   搭建鉴权模块（目前归属于UC系统），各应用间调用需通过鉴权服务验证身份信息。

   A）首先各应用申请颁发 AppKey 和 AppSecret，申请应用需要指定 grant_type（内部应用或外部应用），以及权限范围 scope。 

   B）各应用间访问需要使用 AppKey 和 AppSecret 结合指定签名算法访问。

   C）被访问应用需要携带身份 appKey 及签名 sign 来鉴权服务校验身份，返回校验结果及权限信息。

   D）服务申请方需要提供刷新 AppSecret 的接口，鉴权服务定期刷新此秘jian钥，保证秘钥安全（同样使用 LXY-V1 签名算法调用）。

2. **系统内部应用间访问流程**

   系统内部，服务 A 访问服务 B，需要携带身份信息 AppKey 和签名（根据 **LXY-V1** 算法生成）， 服务 B 接受到服务 A 的请求，使用AppKey 和签名等信息向鉴权服务发起验证，验证通过则返回成功标志和权限信息，验证失败则本次调用失败。

<img src="http://blog-shifty.oss-cn-shanghai.aliyuncs.com/uPic/image-20220411182844861.png" alt="image-20220411182844861" style="zoom:50%;" />

3. **签名算法**

   使用 **LXY-V1**算法签名。
   
   调用方使用 sha1 加密算法，对 AppKey、AppSecret、Date、Url 等进行加密，得到签名。接收方判断传来的 AppKey 是否有效， Date 是否在有效期窗口内（1分钟内），签名是否正确。
   
3. **内部应用列表**

   **[CRM, JXC, SKB, JQR, BMS, PaaS]**

#### 方案注意事项：

1.  鉴权接口的并发量比较高，需要做相应的限流处理。
2. 